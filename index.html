<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>tomoponz｜プロフィール</title>
  <meta name="description" content="tomoponzのプロフィールページ" />

  <link rel="stylesheet" href="style.css?v=20260222">

  <style>
    .quoteBox{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      border-radius: 18px;
      padding: 16px;
    }
    .quoteText{ font-size: 18px; line-height: 1.7; margin: 0 0 8px; }
    .quoteBy{ opacity:.75; margin:0; }
    .btnrow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .btnlike{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 14px; border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      text-decoration:none; color: inherit;
      cursor:pointer;
    }
    .grid3{ display:grid; gap:14px; grid-template-columns: repeat(3, minmax(0,1fr)); }
    @media (max-width: 900px){ .grid3{ grid-template-columns: 1fr; } }
  </style>
</head>

<body class="home">
  <header class="nav">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <b>tomoponz</b><br><small>プロフィール</small>
      </div>
    </div>

    <nav class="navlinks">
      <a class="chip" href="index.html">プロフィール</a>
      <a class="chip" href="omikuji.html">おみくじ</a>
      <a class="chip" href="shindan.html">診断</a>
      <a class="chip" href="gallery.html">ネタ置き場</a>
      <a class="chip" href="links.html">リンク</a>
      <a class="chip" href="games.html">ゲーム</a>
      <a class="chip" href="door.html">ドア</a>
      <a class="chip" href="hachi.html">八百科事典</a>
      
      <div class="nav-search">
        <input type="search" id="searchInput" placeholder="検索キーワードを入力してください" autocomplete="off">
        <button id="searchBtn">検索</button>
      </div>
      </nav>
  </header>

  <main class="wrap">
    
    <button id="dangerBtn" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999; background: rgba(255,0,0,0.1); border: 2px solid #ff4444; color: #ff8888; padding: 10px 16px; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer; box-shadow: 0 0 15px rgba(255,0,0,0.3); letter-spacing: 0.1em; transition: 0.2s; opacity: 0.6;">
      ⚠️ 押すな
    </button>
    <div id="voidClick" style="position: absolute; bottom: 0; left: 0; width: 20px; height: 20px; cursor: default; z-index: 9999;"></div>
    <section class="hero">
      <h1 class="h1" style="margin:0">tomoponz</h1>
      <p class="sub">秘密基地 / ネタ置き場 / ミニゲーム / いろいろ</p>

      <div class="btnrow">
        <a class="btnlike" href="games.html">ゲームへ</a>
        <a class="btnlike" href="links.html">リンク集へ</a>
        </div>
    </section>

    <section class="grid2">
      <div class="card">
        <h2>プロフィール</h2>
        <ul class="list">
          <li>名前：tomoponz</li>
          <li>属性：大学1年（工学・情報寄り）</li>
          <li>やってること：Web / ネタ / ミニゲーム / 演出</li>
          <li>興味：デザイン（Vaporwave / Frutiger Aero） / 数学 / 物理 / 仕組み作り</li>
          <li>メモ：このサイトは気分で増える。没案やログは黒歴史へ保管。</li>
        </ul>
        <div class="note">※住所や通学ルートなど、特定につながる情報は書かない方針</div>
      </div>

      <div class="card">
        <h2>今日の一言（名言）</h2>

        <div class="quoteBox">
          <p class="quoteText" id="quoteText">読み込み中…</p>
          <p class="quoteBy" id="quoteBy"></p>

          <div class="btnrow">
            <button class="btnlike" type="button" id="nextQuoteBtn">次の名言</button>
            <button class="btnlike" type="button" id="copyQuoteBtn">コピー</button>
          </div>
        </div>

        <div class="note devOnly">
          meigen の BASE_QUOTES + user_quotes.js を混ぜる
        </div>
      </div>
    </section>

    <section class="card">
      <h2>ショートカット</h2>
      <div class="grid3">
        <a class="btnlike" href="minigames.html">ミニゲーム一覧</a>
        <a class="btnlike" href="gallery.html">ネタ置き場</a>
        <a class="btnlike" href="door.html">ドア（ワープ演出）</a>
      </div>
    </section>

    <div class="footer">
      © tomoponz | <span id="access-count">Access: ...</span>
    </div>
  </main>

  <script src="app.js?v=20260220"></script>
  <script src="quotes_base.js?v=20260220"></script>
  <script src="user_quotes.js?v=20260220"></script>
  <script src="counter.js?v=20260222"></script>

  <script>
    const BASE = Array.isArray(window.BASE_QUOTES) ? window.BASE_QUOTES : [];

    function normalizeUserQuote(q){
      if(!q || !q.text) return null;
      return {
        text: String(q.text),
        work: String(q.work || "User"),
        character: String(q.character || q.author || "tomoponz"),
        tags: Array.isArray(q.tags) ? q.tags : []
      };
    }

    const USER = Array.isArray(window.USER_QUOTES)
      ? window.USER_QUOTES.map(normalizeUserQuote).filter(Boolean)
      : [];

    const QUOTES = [...BASE, ...USER];

    function pickQuote() {
      if (QUOTES.length === 0) return { text:"(名言データが空)", work:"", character:"" };
      return QUOTES[Math.floor(Math.random() * QUOTES.length)];
    }

    function showQuote(q) {
      const qt = document.getElementById("quoteText");
      const qb = document.getElementById("quoteBy");
      if (!qt || !qb) return;

      qt.textContent = "“" + q.text + "”";
      const meta = [];
      if (q.character) meta.push(q.character);
      if (q.work) meta.push(`（${q.work}）`);
      qb.textContent = meta.length ? "— " + meta.join("") : "";
    }

    function loadQuote(){ showQuote(pickQuote()); }

    async function copyCurrent(){
      const text = document.getElementById("quoteText")?.textContent || "";
      const by = document.getElementById("quoteBy")?.textContent || "";
      const payload = (text + "\n" + by).trim();
      try{
        await navigator.clipboard.writeText(payload);
        alert("コピーしました");
      }catch{
        const ta = document.createElement("textarea");
        ta.value = payload;
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        document.body.appendChild(ta);
        ta.focus(); ta.select();
        try{ document.execCommand("copy"); alert("コピーしました"); }catch{ alert("コピー失敗"); }
        document.body.removeChild(ta);
      }
    }

    window.addEventListener("load", () => {
      loadQuote();
      document.getElementById("nextQuoteBtn")?.addEventListener("click", loadQuote);
      document.getElementById("copyQuoteBtn")?.addEventListener("click", copyCurrent);
    });
  </script>
  <script>
    // 1. F12 コンソールへの語りかけ（パスコードのヒント）
    console.log("%c[SYSTEM] 端末からのアクセスを検知。監視プロトコルを開始します。", "color: #888; font-size: 11px;");
    console.log("%c[WARNING] 当サイトのソースコードを閲覧している方へ。これ以上の深入りは推奨しません。", "color: #ff0000; font-weight: bold; font-size: 14px;");
    console.log("%c 機密領域アクセスコード: 'kuro-n-tomo' ", "color: #000; background-color: #000; padding: 2px;");

    // 2. 隠しログインの処理（左下クリック）
    const voidClick = document.getElementById("voidClick");
    if (voidClick) {
      voidClick.addEventListener("click", () => {
        const code = prompt("【管理システム】\nアクセス権限が必要です。パスコードを入力してください。");
        if (code === "kuro-n-tomo") {
          alert("認証完了。裏付けされた記録を開示します。");
          location.href = "deep.html"; 
        } else if (code) {
          alert("エラー：記録にない個体です。監視レベルを引き上げます。");
        }
      });
    }

    // 3. ハイブリッドサイト内検索
    const searchBtn = document.getElementById("searchBtn");
    const searchInput = document.getElementById("searchInput");

    // サイト内の簡易案内辞書（※黒歴史は削除済）
    const siteIndex = [
      { keywords: ["プロフィール", "profile", "名前", "tomoponz", "自己紹介"], url: "index.html" },
      { keywords: ["おみくじ", "占い", "運勢", "omikuji", "大吉", "凶"], url: "omikuji.html" },
      { keywords: ["診断", "shindan", "性格", "タイプ"], url: "shindan.html" },
      { keywords: ["ネタ", "ギャラリー", "gallery", "ネタ置き場", "画像"], url: "gallery.html" },
      { keywords: ["リンク", "links", "お気に入り", "おすすめ"], url: "links.html" },
      { keywords: ["ゲーム", "games", "遊ぶ", "game"], url: "games.html" },
      { keywords: ["ミニゲーム", "minigames", "暇つぶし", "minigame"], url: "minigames.html" },
      { keywords: ["ドア", "door", "ワープ", "warp", "移動"], url: "door.html" },
      { keywords: ["八百科事典", "hachi", "事典", "辞典", "百科事典"], url: "hachi.html" },
      { keywords: ["名言", "meigen", "迷言", "セリフ", "言葉"], url: "meigen.html" }
    ];

    if (searchBtn && searchInput) {
      const executeSearch = () => {
        const query = searchInput.value.trim();
        if (query === "") return;

        // 【裏コード】
        if (query === "kuro-n-tomo") {
          alert("認証完了。裏付けされた記録を開示します。");
          location.href = "deep.html"; 
          return;
        }

        // ★黒歴史ワードは検索対象外（ヒットさせない＆Google検索にも投げない）
        const blocked = /黒歴史|kuro/i;
        if (blocked.test(query)) {
          alert("そのキーワードは検索対象外。");
          return;
        }

        // 【簡易ナビゲーション】
        const lowerQuery = query.toLowerCase();
        let foundUrl = null;
        for (const page of siteIndex) {
          if (page.keywords.some(kw => kw.includes(lowerQuery) || lowerQuery.includes(kw))) {
            foundUrl = page.url;
            break;
          }
        }

        if (foundUrl) {
          if (confirm(`「${query}」に関連するページが見つかりました。\n移動しますか？`)) {
            location.href = foundUrl;
          }
        } else {
          // 【Googleサイト内検索】
          if (confirm(`サイト内の主要ページに「${query}」は見つかりませんでした。\nGoogleを使用してサイト全体から検索しますか？`)) {
            let domain = window.location.hostname;
            if (domain === "localhost" || domain === "127.0.0.1" || domain === "") {
              domain = "tomoponz.github.io"; // 本番ドメイン
            }
            const googleSearchUrl = `https://www.google.com/search?q=site:${domain}+${encodeURIComponent(query)}`;
            window.open(googleSearchUrl, "_blank");
          }
        }
      };

      searchBtn.addEventListener("click", executeSearch);
      searchInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") executeSearch();
      });
    }

// 4. 絶対に押してはいけないボタンの処理（絶望ホラー演出版・初期音声追加）
    const dangerBtn = document.getElementById("dangerBtn");
    if (dangerBtn) {
      dangerBtn.addEventListener("click", () => {
        
        // 事前に読み込んでおく（遅延タイミングでも確実に鳴らす）
        try{ if(window.preloadSfx){ window.preloadSfx("nigasanai"); } }catch(e){}

        // ★ クリックした瞬間に音声（osuna）を鳴らす ★
        // app.js の playSfx が使えるならそれを優先
        if (window.playSfx) {
          window.playSfx("osuna", 1.0);
        } else {
          const nanikoreSound = new Audio("assets/sfx/nanikore.wav");
          nanikoreSound.volume = 1.0;
          nanikoreSound.play().catch(() => {});
        }

        // 音が鳴るのと同時にダイアログが出ると音が消える場合があるため、0.1秒(100ミリ秒)だけ遅らせて警告を出す
        setTimeout(() => {
          if (!confirm("警告：絶対に押すなと言いましたよね？本当に実行しますか？")) return;
          if (!confirm("後悔しますよ。本当にいいんですね？")) return;
          if (!confirm("最終警告です。この先、何が起きても一切の責任を負いません。")) return;
          
          // 1. 画面を狂わせるCSSを動的に追加
          const style = document.createElement('style');
          style.innerHTML = `
            @keyframes violent-shake {
              0% { transform: translate(2px, 1px) rotate(0deg); }
              10% { transform: translate(-1px, -2px) rotate(-1deg); }
              20% { transform: translate(-3px, 0px) rotate(1deg); }
              30% { transform: translate(3px, 2px) rotate(0deg); }
              40% { transform: translate(1px, -1px) rotate(1deg); }
              50% { transform: translate(-1px, 2px) rotate(-1deg); }
              60% { transform: translate(-3px, 1px) rotate(0deg); }
              70% { transform: translate(3px, 1px) rotate(-1deg); }
              80% { transform: translate(-1px, -1px) rotate(1deg); }
              90% { transform: translate(1px, 2px) rotate(0deg); }
              100% { transform: translate(1px, -2px) rotate(-1deg); }
            }
            .horror-glitch {
              animation: violent-shake 0.1s infinite;
              filter: invert(1) contrast(150%) hue-rotate(180deg);
              background-color: #000 !important;
              cursor: crosshair !important;
            }
            .horror-glitch * {
              cursor: crosshair !important;
            }

            /* --- fake terminal / hack overlay --- */
            #hackOverlay{
              position:fixed; inset:0;
              background:rgba(0,0,0,.55);
              z-index: 9000;
              pointer-events:none;
            }
            #hackOverlay .cmd{
              position:absolute; left:12px; right:12px; bottom:12px; top:12px;
              border:1px solid rgba(255,255,255,.18);
              border-radius:14px;
              overflow:hidden;
              box-shadow:0 18px 60px rgba(0,0,0,.55);
            }
            #hackOverlay .bar{
              height:34px;
              background:linear-gradient(to right, #111, #2a2a2a);
              color:#eaeaea;
              font: 12px/34px Tahoma, 'MS UI Gothic', sans-serif;
              padding:0 10px;
              display:flex; justify-content:space-between;
              opacity:.95;
            }
            #hackOverlay .screen{
              position:absolute; left:0; right:0; top:34px; bottom:0;
              padding:10px 12px;
              font: 12px/1.35 ui-monospace, SFMono-Regular, Menlo, Consolas, "Courier New", monospace;
              color:#67ff6b;
              opacity:.55;
              white-space:pre-wrap;
              overflow:hidden;
              text-shadow:0 0 10px rgba(80,255,80,.15);
            }
            #hackOverlay .cursor{display:inline-block; width:10px; animation:blink 1s infinite;}
            @keyframes blink { 0%,49% { opacity: 1; } 50%,100% { opacity: 0; } }
          `;
          document.head.appendChild(style);
          try{
            if(window.parent && window.parent !== window){
              window.parent.postMessage({type:"IMMERSION", active:true}, location.origin);
            }
          }catch(_){
            try{ window.parent && window.parent.postMessage({type:"IMMERSION", active:true}, "*"); }catch(__){}
          }

          document.body.classList.add("horror-glitch");

          // 0. 背後で勝手に入力される「それっぽい」画面（※実害なしの演出）
          const hackOverlay = document.createElement('div');
          hackOverlay.id = 'hackOverlay';
          hackOverlay.innerHTML = `
            <div class="cmd">
              <div class="bar"><span>cmd.exe - SYSTEM</span><span>◻︎  ×</span></div>
              <div class="screen" id="hackScreen"></div>
            </div>
          `;
          document.body.appendChild(hackOverlay);

          const hackScreen = hackOverlay.querySelector('#hackScreen');
          const hackLines = [
            "C:\\\\Windows\\\\System32> init.sys --force --silent",
            "[+] collecting entropy... ok",
            "[+] scanning memory pages... 0x00000000 -> 0x00FFFFFF",
            "[!] signature mismatch: 0xDEAD BEEF (retry)",
            "[+] patching hooks: ntoskrnl.exe ...",
            "[+] dumping tokens: 12 found",
            "[+] negotiating channel: AES-256-GCM",
            "[+] uploading fragments: 1/9 2/9 3/9 4/9",
            "[!] I SEE YOU",
            "[+] writing...",
            "\n",
          ];

          let hl = 0;
          let hc = 0;
          let current = "";
          const typeTimer = setInterval(() => {
            // 文字を少しずつ打つ
            const line = hackLines[hl] ?? ("0x" + Math.floor(Math.random()*0xFFFFFF).toString(16).padStart(6,'0').toUpperCase() + "  " + Math.random().toString(36).slice(2));
            if (hc < line.length){
              current += line[hc++];
            } else {
              current += "\n";
              hl++;
              hc = 0;
            }
            // 長すぎたら切る
            if (current.length > 6000) current = current.slice(current.length - 6000);
            hackScreen.innerHTML = current + "<span class=\"cursor\">█</span>";
          }, 22);

          // 不気味なメッセージのリスト
          const creepyMessages = [
            "メモリが\"read\"になることはできませんでした。",
            "システムファイルが破損しています。",
            "なぜ押したの？",
            "警告したはずです",
            "データ消去中...",
            "I  S E E  Y O U",
            "う し ろ を ふ り む か な い で",
            "助けて助けて助けて助けて助けて",
            "もう手遅れです"
          ];

          let errorCount = 0;

          // 増殖するエラーの音（前回設定した Windowsエラー音 m4a）
          const playDistortedSound = () => {
            try{
              if(typeof window.getAudioEnabled === 'function' && !window.getAudioEnabled()) return;
            }catch(_){ }

            // 共通の playSfx 経由（音声OFFも反映される）
            if(window.playSfx){
              try{ window.playSfx('assets/sfx/windows error sound.m4a', 0.6); return; }catch(e){}
            }

            try{
              const se = new Audio(encodeURI('assets/sfx/windows error sound.m4a'));
              se.volume = 0.6;
              se.play().catch(() => {});
            }catch(e){}
          };

          // 異常なエラーウィンドウを生成する関数
          const createFakeError = () => {
            playDistortedSound();
            errorCount++;

            const div = document.createElement("div");
            div.style.position = "fixed";
            div.style.left = Math.random() * (window.innerWidth - 300) + "px";
            div.style.top = Math.random() * (window.innerHeight - 150) + "px";
            div.style.width = "320px";
            
            const isLateStage = errorCount > 20;
            div.style.backgroundColor = isLateStage ? "#4a0000" : "#ece9d8"; 
            div.style.border = isLateStage ? "2px solid #ff0000" : "2px solid #0055ea";
            div.style.boxShadow = "5px 5px 15px rgba(0,0,0,0.8)";
            div.style.color = isLateStage ? "#ff0000" : "#000";
            div.style.zIndex = Math.floor(Math.random() * 10000) + 10000;
            div.style.fontFamily = "Tahoma, 'MS UI Gothic', sans-serif";

            const errorCode = Math.floor(Math.random() * 16777215).toString(16).toUpperCase().padStart(6, '0');
            
            let msgText = creepyMessages[0];
            if (errorCount > 5) msgText = creepyMessages[Math.floor(Math.random() * creepyMessages.length)];
            if (errorCount > 30) msgText = "死死死死死死死死死死死死死"; 

            const title = isLateStage ? 'FATAL ERROR' : 'System Error';
            const barBg = isLateStage ? 'linear-gradient(to right, #000, #2a0000)' : 'linear-gradient(to right, #0058e6, #3a93ff)';
            div.innerHTML = `
              <div class="fake-bar" style="background:${barBg}; color:white; padding:4px 8px; font-size:13px; font-weight:bold; display:flex; justify-content:space-between; user-select:none;">
                <span>${title}</span>
                <span class="fake-close" style="background:#e04343; border-radius:3px; padding:0 6px; cursor:pointer;">×</span>
              </div>
              <div style="padding:14px 14px 16px; display:flex; gap:12px; align-items:flex-start;">
                <div style="width:36px;height:36px;border-radius:8px;background:${isLateStage?'#ff0000':'#0055ea'};display:grid;place-items:center;color:white;font-weight:bold;">!</div>
                <div style="flex:1;">
                  <div style="font-size:${isLateStage?'16px':'13px'}; font-weight:${isLateStage?'bold':'normal'}; line-height:1.35;">
                    ${isLateStage ? 'Fatal Error' : 'An exception has occurred.'}<br>
                    0x${errorCode} — ${msgText}
                  </div>
                  <div style="margin-top:10px; font-size:11px; opacity:.8;">If this problem persists, contact your system administrator.</div>
                  <div style="margin-top:12px; text-align:right;">
                    <button class="fake-ok" style="min-width:88px; padding:5px 16px; cursor:pointer; color:black; border:1px solid rgba(0,0,0,.25); background:#f2f2f2;">OK</button>
                  </div>
                </div>
              </div>
            `;
            document.body.appendChild(div);

            const multiplyErrors = (e) => {
              e.preventDefault();
              e.stopPropagation();
              createFakeError();
              createFakeError();
              createFakeError(); 
            };

            div.querySelector(".fake-close").addEventListener("click", multiplyErrors);
            div.querySelector(".fake-ok").addEventListener("click", multiplyErrors);
          };

          // 最初の連鎖発動
          let initCount = 0;
          const chaosInterval = setInterval(() => {
            createFakeError();
            initCount++;
            if (initCount > 10) clearInterval(chaosInterval);
          }, 200);

          // ★別タブを開かない（スマホで暴発しやすいので禁止）
          
          setTimeout(() => {
            // 「逃がさない」音声
            if(window.playSfx){ try{ window.playSfx("nigasanai", 1.0, {boost: 2.8}); }catch(e){} }
            // 最終演出（DOMを全消ししない：エラー増殖と背景タイピングを残す）
            const finale = document.createElement('div');
            finale.style.position = 'fixed';
            finale.style.inset = '0';
            finale.style.background = 'rgba(0,0,0,.92)';
            finale.style.zIndex = '20000';
            finale.style.display = 'grid';
            finale.style.placeItems = 'center';
            finale.style.fontFamily = 'serif';
            finale.innerHTML = "<div style='text-align:center;'><div style='color:#ff2b2b; font-size:52px; letter-spacing:6px;'>逃 が さ な い</div><div style='margin-top:10px; color:#aaa; font-size:12px;'>SYSTEM OVERRIDE</div></div>";
            document.body.appendChild(finale);

            clearInterval(typeTimer);

            setTimeout(() => {
              try{
                if(window.parent && window.parent !== window){
                  window.parent.postMessage({type:"NAV", href:"horror.html"}, location.origin);
                }else{
                  location.href = "horror.html";
                }
              }catch(_){
                try{ window.parent && window.parent.postMessage({type:"NAV", href:"horror.html"}, "*"); }catch(__){}
                try{ location.href = "horror.html"; }catch(__){}
              }
            }, 1800);
          }, 6000);

        }, 100); // ← 0.1秒だけ待ってから警告ダイアログを出す
      });
      
      dangerBtn.addEventListener("mouseenter", () => {
        dangerBtn.style.transform = "translate(2px, -2px)";
        setTimeout(() => dangerBtn.style.transform = "translate(-2px, 2px)", 50);
        setTimeout(() => dangerBtn.style.transform = "translate(0, 0)", 100);
      });
    }
  </script>
    
</body>
</html>
