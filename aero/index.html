<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Aero OS 2007 - Ultimate Clutter</title>
  <link rel="stylesheet" href="style.css">
  <script defer src="../app.js?v=20260224-3"></script>
  <script defer src="../assets/js/security-lite.js?v=20260222"></script>
</head>
<body>

  <img src="../img/rainbow.png" class="bg-element rainbow" alt="Rainbow">
  <div class="clouds">
    <img src="../img/cloud.png" class="bg-element cloud cloud-1" alt="Cloud">
    <img src="../img/cloud.png" class="bg-element cloud cloud-2" alt="Cloud">
  </div>
  <img src="../img/dolphin.png" class="bg-element dolphin" alt="Dolphin">
  <img src="../img/butterfly.png" class="bg-element butterfly" alt="Butterflies">
  <div class="aero-bg"></div>
  <div class="bubbles-container">
    <div class="bubble"></div><div class="bubble"></div><div class="bubble"></div>
  </div>

  <div class="sticky-note" style="top: 150px; left: 300px; transform: rotate(-2deg);">
    <p>TODO:<br>- イルカに餌をやる<br>- 仮想空間のデフラグ<br>- Wake up.</p>
  </div>
  <img src="../img/dolphin.png" class="desktop-loose-img" style="top: 350px; left: 80px; width: 100px; transform: rotate(15deg);">

  <div class="desktop-icons">
    <div class="icon-column">
      <div class="icon" ondblclick="openAeroWindow('welcome-win')" onclick="if(window.innerWidth<=600) openAeroWindow('welcome-win')">
        <img src="../img/globe.png" class="desktop-img" alt="Network"><span>ネットワーク</span>
      </div>
      <div class="icon" ondblclick="location.href='../liminal/index.html'" onclick="if(window.innerWidth<=600) location.href='../liminal/index.html'">
        <img src="../img/green%20folder.png" class="desktop-img" alt="Folder"><span>古い記録 (Level 0)</span>
      </div>
      <div class="icon" ondblclick="location.href='../vaporwave/index.html'" onclick="if(window.innerWidth<=600) location.href='../vaporwave/index.html'">
        <img src="../img/CD.png" class="desktop-img" alt="Disk"><span>Ｖ Ｉ Ｒ Ｔ Ｕ Ａ Ｌ</span>
      </div>
      <div class="icon" ondblclick="openAeroWindow('notepad-win-1')" onclick="if(window.innerWidth<=600) openAeroWindow('notepad-win-1')">
        <div class="glossy-icon file-icon">📄</div><span>未確認のメモ.txt</span>
      </div>
      <div class="icon" ondblclick="openAeroWindow('photo-win')" onclick="if(window.innerWidth<=600) openAeroWindow('photo-win')">
        <img src="../img/beach.png" class="desktop-img" alt="Photos"><span>写真素材集</span>
      </div>
    </div>
    <div class="icon-column">
      <div class="icon" ondblclick="openAeroWindow('ie-win')" onclick="if(window.innerWidth<=600) openAeroWindow('ie-win')">
        <img src="../img/compass.png" class="desktop-img" alt="Browser"><span>Aero Explorer</span>
      </div>
      <div class="icon" ondblclick="openAeroWindow('wmp-win')" onclick="if(window.innerWidth<=600) openAeroWindow('wmp-win')">
        <img src="../img/music%20folder.png" class="desktop-img" alt="Music"><span>思い出の曲</span>
      </div>
      <div class="icon" ondblclick="openAeroWindow('notepad-win-2')" onclick="if(window.innerWidth<=600) openAeroWindow('notepad-win-2')">
        <div class="glossy-icon file-icon">📄</div><span>パスワード案.txt</span>
      </div>
      <div class="icon" ondblclick="openAeroWindow('trash-win')" onclick="if(window.innerWidth<=600) openAeroWindow('trash-win')">
        <img src="../img/dust%20box.png" class="desktop-img" alt="Trash" id="desktop-trash-icon"><span>ごみ箱 (満杯)</span>
      </div>
    </div>
  </div>

  <div class="sidebar-gadgets">
    <div class="gadget clock-gadget"><div class="clock-face"><div class="hand hour" id="hour-hand"></div><div class="hand minute" id="minute-hand"></div><div class="hand second" id="second-hand"></div><div class="center-dot"></div></div></div>
    <div class="gadget cpu-gadget"><div class="gauge-dial"><div class="gauge-needle" id="cpu-needle"></div><span style="position:absolute; bottom: 20px; font-size: 10px;">CPU</span></div></div>
    <div class="gadget weather-gadget" style="background: transparent; border: none; box-shadow: none;"><img src="../img/weather.png" style="width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));" alt="Weather"></div>
  </div>

  <div class="aero-window panel-bg" id="welcome-win" style="display: none; width: 90%; max-width: 550px;" onmousedown="bringToFront('welcome-win')">
    <div class="title-bar">
      <div class="title-text"><span class="title-icon">✨</span> ウェルカム センター</div>
      <div class="window-controls"><button class="ctrl-btn min-btn">—</button><button class="ctrl-btn max-btn">□</button><button class="ctrl-btn close-btn" onclick="closeAeroWindow('welcome-win')">✕</button></div>
    </div>
    <div class="window-content semi-transparent">
      <div class="content-header"><h2>Aero OS 2007 へようこそ</h2><p>自然とテクノロジーが融合した、理想郷（ユートピア）へ。</p></div>
      <div class="content-body">
        <div class="feature-box"><h3>💧 水滴ガラスパネル</h3><p>新しく搭載された、濡れたガラスのような美しいUI。</p></div>
        <div class="feature-box"><h3>🐬 Frutiger Aero</h3><p>澄み切った青空、透き通る水、そしてイルカ。2000年代の夢。</p></div>
      </div>
    </div>
  </div>

  <div class="aero-window" id="ie-win" style="display: none; width: 600px; height: 400px;" onmousedown="bringToFront('ie-win')">
    <div class="glass-highlight"></div>
    <div class="title-bar">
      <div class="title-text"><span class="title-icon">🌐</span> Aero Explorer</div>
      <div class="window-controls"><button class="ctrl-btn min-btn">—</button><button class="ctrl-btn max-btn">□</button><button class="ctrl-btn close-btn" onclick="closeAeroWindow('ie-win')">✕</button></div>
    </div>
    <div class="window-content" style="background: #fff;">
      <div class="browser-toolbar">
        <button class="nav-btn">◀</button> <button class="nav-btn">▶</button>
        <input type="text" class="url-bar" value="http://www.aero-utopia.net/dolphin_fan_club" readonly>
      </div>
      <div class="content-body" style="height: 100%; display: flex; align-items: center; justify-content: center; flex-direction: column;">
        <img src="../img/compass.png" style="width: 80px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2)); margin-bottom: 20px; opacity: 0.7;">
        <h2 style="color: #0078d7; margin: 0 0 10px 0; font-size: 16px;">ページを表示できません</h2>
        <p style="color: #666; font-size: 12px; text-align: center;">検索中のページは、削除されたか、名前が変更されたか、<br>または現在利用できない可能性があります。</p>
        <p style="color: #888; font-size: 11px; margin-top: 20px;">HTTP 404 - ファイル未検出<br>Aero Explorer</p>
      </div>
    </div>
  </div>

  <div class="aero-window" id="wmp-win" style="display: none; width: 500px;" onmousedown="bringToFront('wmp-win')">
    <div class="glass-highlight"></div>
    <div class="title-bar">
      <div class="title-text"><span class="title-icon">🎵</span> Windows Media Player</div>
      <div class="window-controls"><button class="ctrl-btn min-btn">—</button><button class="ctrl-btn max-btn">□</button><button class="ctrl-btn close-btn" onclick="closeAeroWindow('wmp-win')">✕</button></div>
    </div>
    <div class="window-content" style="background: #111; color: #fff;">
      <div style="height: 150px; background: #000; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;">
        <div class="visualizer-bar" style="left: 30%; animation-delay: 0.1s;"></div><div class="visualizer-bar" style="left: 40%; animation-delay: 0.3s;"></div><div class="visualizer-bar" style="left: 50%; animation-delay: 0.2s;"></div><div class="visualizer-bar" style="left: 60%; animation-delay: 0.5s;"></div><div class="visualizer-bar" style="left: 70%; animation-delay: 0.4s;"></div>
      </div>
      <div style="padding: 15px; display: flex; align-items: center; justify-content: space-between; background: linear-gradient(to bottom, #333, #111);">
        <div>
          <h4 id="wmpTitle" style="margin: 0; font-size: 14px; color: #55e6ff;">Uiiissudo-mosyamude-su.mp3</h4>
          <span id="wmpArtist" style="font-size: 11px; color: #aaa;">Frutiger Aero Soundtrack</span>
        </div>
        <div style="display: flex; gap: 10px;">
          <button class="player-btn" id="wmpPrevBtn">⏮</button>
          <button class="player-btn" id="wmpPlayBtn" style="transform: scale(1.2);">▶</button>
          <button class="player-btn" id="wmpNextBtn">⏭</button>
        </div>
      </div>
    </div>
  </div>

  <!-- WMPはこの1本だけを制御（曲切替で被りを防ぐ） -->
  <audio id="wmpAudio" preload="auto" loop></audio>


  <div class="aero-window" id="notepad-win-1" style="display: none; width: 400px; height: 300px;" onmousedown="bringToFront('notepad-win-1')">
    <div class="glass-highlight"></div>
    <div class="title-bar">
      <div class="title-text">📄 未確認のメモ.txt - メモ帳</div>
      <div class="window-controls"><button class="ctrl-btn close-btn" onclick="closeAeroWindow('notepad-win-1')">✕</button></div>
    </div>
    <div class="notepad-menu">ファイル(F)  編集(E)  書式(O)  表示(V)  ヘルプ(H)</div>
    <div class="window-content" style="background: #fff; border: none;">
      <textarea class="notepad-textarea" readonly>昨日の夢にイルカが出てきた。
透き通る水の中で、ずっとこちらを見ていた。

このOSからログアウトする方法が見つからない。
戻るボタンは機能しない。
私たちはここで、ずっと「2007年」を生き続けるのだろうか。</textarea>
    </div>
  </div>

  <div class="aero-window" id="notepad-win-2" style="display: none; width: 350px; height: 250px;" onmousedown="bringToFront('notepad-win-2')">
    <div class="glass-highlight"></div>
    <div class="title-bar">
      <div class="title-text">📄 パスワード案.txt - メモ帳</div>
      <div class="window-controls"><button class="ctrl-btn close-btn" onclick="closeAeroWindow('notepad-win-2')">✕</button></div>
    </div>
    <div class="notepad-menu">ファイル(F)  編集(E)  書式(O)  表示(V)  ヘルプ(H)</div>
    <div class="window-content" style="background: #fff; border: none;">
      <textarea class="notepad-textarea" readonly>Admin: Aero_Admin_07
Dolphin: Splash_2007
System: Frutiger_Utopia
Root: Wake_Up_Now</textarea>
    </div>
  </div>

  <div class="aero-window" id="trash-win" style="display: none; width: 500px; height: 350px;" onmousedown="bringToFront('trash-win')">
    <div class="glass-highlight"></div>
    <div class="title-bar">
      <div class="title-text">🗑️ ごみ箱</div>
      <div class="window-controls"><button class="ctrl-btn close-btn" onclick="closeAeroWindow('trash-win')">✕</button></div>
    </div>
    <div class="window-content" style="background: #fff;">
      <div class="explorer-toolbar" style="padding: 10px; background: #f0f0f0; border-bottom: 1px solid #ccc;">
        <button onclick="emptyTrash()" style="padding: 5px 10px; cursor: pointer;">🗑️ ごみ箱を空にする</button>
      </div>
      <div id="trash-contents" style="padding: 15px; display: flex; gap: 20px;">
        <div style="text-align: center;"><div class="glossy-icon file-icon">📄</div><br><span style="font-size: 11px;">古い日記.txt</span></div>
        <div style="text-align: center;"><div class="glossy-icon zip-icon">📦</div><br><span style="font-size: 11px;">現実の記憶.zip</span></div>
      </div>
    </div>
  </div>

  <div class="aero-window" id="photo-win" style="display: none; width: 500px; height: 400px;" onmousedown="bringToFront('photo-win')">
    <div class="glass-highlight"></div>
    <div class="title-bar">
      <div class="title-text">🖼️ Windows フォト ギャラリー</div>
      <div class="window-controls"><button class="ctrl-btn close-btn" onclick="closeAeroWindow('photo-win')">✕</button></div>
    </div>
    <div class="window-content" style="background: #222; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px;">
      <img src="../img/beach.png" style="max-width: 100%; max-height: 80%; border: 3px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.8);">
      <div style="margin-top: 15px; display: flex; gap: 15px;">
        <button class="player-btn">◀</button>
        <button class="player-btn" style="transform: scale(1.2);">▶</button>
      </div>
    </div>
  </div>

  <div class="start-menu" id="start-menu">
    <div class="user-profile-top"><div class="user-icon-frame"><div class="user-icon-inner">🌸</div></div></div>
    <div class="start-menu-inner">
      <div class="start-menu-left">
        <div class="menu-item" onclick="location.href='../liminal/index.html'"><img src="../img/green%20folder.png" class="menu-img-icon" alt="icon"><div class="menu-text">Backrooms (Level 0)</div></div>
        <div class="menu-item" onclick="location.href='../vaporwave/index.html'"><img src="../img/CD.png" class="menu-img-icon" alt="icon"><div class="menu-text">Virtual Plaza</div></div>
        <div class="menu-separator"></div>
        <div class="menu-item" onclick="openAeroWindow('ie-win'); toggleStartMenu();"><img src="../img/compass.png" class="menu-img-icon" alt="icon"><div class="menu-text">Internet Explorer</div></div>
        <div class="menu-item" onclick="openAeroWindow('wmp-win'); toggleStartMenu();"><img src="../img/music%20folder.png" class="menu-img-icon" alt="icon"><div class="menu-text">Media Player</div></div>
        <div class="start-search-box"><input type="text" placeholder="検索の開始"><span class="search-icon">🔍</span></div>
      </div>
      <div class="start-menu-right">
        <div class="menu-item-right"><strong>Guest User</strong></div>
        <div class="menu-separator-right"></div>
        <div class="menu-item-right" onclick="openAeroWindow('photo-win'); toggleStartMenu();">ピクチャ</div>
        <div class="menu-item-right" onclick="openAeroWindow('wmp-win'); toggleStartMenu();">ミュージック</div>
        <div class="menu-separator-right"></div>
        <div class="menu-item-right" onclick="openAeroWindow('welcome-win'); toggleStartMenu();">コントロール パネル</div>
        <div class="menu-item-right" style="display: flex; align-items: center; gap: 5px;"><img src="../img/help%20logo.png" style="width: 16px; height: 16px;"> ヘルプとサポート</div>
        <div class="power-section"><button class="power-btn">🔒</button><button class="power-btn" style="color: #ff5555;">⏻</button></div>
      </div>
    </div>
  </div>

  <div class="taskbar">
    <div class="taskbar-glass"></div>
    <div class="start-orb-image" onclick="toggleStartMenu()" id="start-btn"></div>
    <div class="taskbar-items" id="taskbar-items"></div>
    <div class="tray"><span>🛡️</span><span>🌐</span><span>🔊</span><span id="taskbar-time">12:00</span></div>
  </div>

  <script>
    // スタートメニュー開閉
    function toggleStartMenu() { const menu = document.getElementById('start-menu'); menu.classList.toggle('active'); }
    document.addEventListener('click', function(e) { const menu = document.getElementById('start-menu'); const btn = document.getElementById('start-btn'); if (!menu.contains(e.target) && !btn.contains(e.target)) { menu.classList.remove('active'); } });

    // ★ ウィンドウを画面中央に開くロジック ★
    let highestZIndex = 100;
    function openAeroWindow(id) { 
      const win = document.getElementById(id);
      win.style.display = 'flex'; 
      
      // 画面中央の座標を計算
      const winWidth = win.offsetWidth;
      const winHeight = win.offsetHeight;
      const x = (window.innerWidth - winWidth) / 2;
      const y = (window.innerHeight - winHeight) / 2;
      
      win.style.left = x + 'px';
      win.style.top = y + 'px';
      win.style.transform = 'none'; // CSSの中央寄せを解除してJSの座標を優先
      
      bringToFront(id); 
    }
    
    function closeAeroWindow(id) { document.getElementById(id).style.display = 'none'; }
    function bringToFront(id) { highestZIndex++; document.getElementById(id).style.zIndex = highestZIndex; }

    // ドラッグ処理
    const windows = document.querySelectorAll('.aero-window');
    windows.forEach(win => {
      const titleBar = win.querySelector('.title-bar'); let isDragging = false, offsetX, offsetY;
      const startDrag = (clientX, clientY) => { isDragging = true; bringToFront(win.id); const rect = win.getBoundingClientRect(); offsetX = clientX - rect.left; offsetY = clientY - rect.top; win.style.transform = 'none'; win.style.left = rect.left + 'px'; win.style.top = rect.top + 'px'; };
      titleBar.addEventListener('mousedown', (e) => { if(e.target.closest('.ctrl-btn')) return; startDrag(e.clientX, e.clientY); });
      titleBar.addEventListener('touchstart', (e) => { if(e.target.closest('.ctrl-btn')) return; startDrag(e.touches[0].clientX, e.touches[0].clientY); }, {passive: true});
      const moveDrag = (clientX, clientY) => { if(!isDragging) return; win.style.left = (clientX - offsetX) + 'px'; win.style.top = (clientY - offsetY) + 'px'; };
      document.addEventListener('mousemove', (e) => { if(isDragging) moveDrag(e.clientX, e.clientY); }); document.addEventListener('touchmove', (e) => { if(isDragging) moveDrag(e.touches[0].clientX, e.touches[0].clientY); }, {passive: true});
      document.addEventListener('mouseup', () => { isDragging = false; }); document.addEventListener('touchend', () => { isDragging = false; });
    });

    // 時計・CPU更新
    function updateClock() {
      const now = new Date(); let h = now.getHours(); const m = String(now.getMinutes()).padStart(2, '0'); document.getElementById('taskbar-time').innerText = `${h}:${m}`;
      const sec = now.getSeconds(); const min = now.getMinutes(); const hr = now.getHours();
      document.getElementById('second-hand').style.transform = `translateX(-50%) rotate(${sec * 6}deg)`; document.getElementById('minute-hand').style.transform = `translateX(-50%) rotate(${min * 6 + sec * 0.1}deg)`; document.getElementById('hour-hand').style.transform = `translateX(-50%) rotate(${hr * 30 + min * 0.5}deg)`;
    }
    setInterval(updateClock, 1000); updateClock();
    setInterval(() => { const cpuNeedle = document.getElementById('cpu-needle'); const randomAngle = Math.random() * 180 - 90; cpuNeedle.style.transform = `translateX(-50%) rotate(${randomAngle}deg)`; }, 800);

    // ★ ごみ箱を空にするギミック ★
    function emptyTrash() {
      // UI: empty
      document.getElementById('trash-contents').innerHTML = '<p style="color:#888; font-size:12px; margin-top:20px;">ごみ箱は空です</p>';
      document.getElementById('desktop-trash-icon').style.opacity = '0.5'; // デスクトップのアイコンを薄くする（空の表現）

      // Gate: sweetdeath.html can be opened ONLY via this button
      try{ localStorage.setItem('tpz_gate_sweetdeath_v1', String(Date.now())); }catch(_){ }
      // go
      try{ window.location.href = '../vaporwave/sweetdeath.html'; }catch(_){ }
    }

    // ===== Media Player =====
    // WMPの操作（再生/次/前）は app.js 側の initAeroWmpUI() が担当します。



    // ★ 初期状態：Aero Explorer と Media Player を中央に開く ★
    window.onload = () => {
      openAeroWindow('wmp-win');
      // 少しずらして上に重ねる
      setTimeout(() => { openAeroWindow('ie-win'); }, 100);
    };
  </script>
</body>
</html>
