<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Wake up.</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <svg style="width:0; height:0; position:absolute;">
    <filter id="dream-warp">
      <feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="3" result="noise">
        <animate attributeName="baseFrequency" values="0.015;0.025;0.015" dur="10s" repeatCount="indefinite" />
      </feTurbulence>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="30" xChannelSelector="R" yChannelSelector="G" />
    </filter>
  </svg>

  <div class="sky warp-effect"></div>
  <div class="ground warp-effect"></div>

  <img src="../img/cloud.png" class="weird-cloud warp-effect" style="top: 10%; left: 10%; animation-duration: 40s;">
  <img src="../img/cloud.png" class="weird-cloud warp-effect" style="top: 25%; left: 60%; animation-duration: 35s; transform: scale(1.5);">
  <img src="../img/rainbow.png" class="weird-rainbow warp-effect" alt="Rainbow">

  <div class="crazy-clock">
    <div class="clock-face">
      <div class="hand hour" id="crazy-hour"></div>
      <div class="hand minute" id="crazy-minute"></div>
      <div class="hand second" id="crazy-second"></div>
      <div class="center-dot"></div>
    </div>
  </div>

  <div class="crt-overlay"></div>
  <div class="noise"></div>

  <div class="center-message" id="main-text">Wake up.</div>

  <div id="text-container"></div>
  <div id="dummy-btn-container"></div>

  <div class="eye-container" style="top: 20%; left: 15%;"><div class="eye"><div class="pupil"></div></div></div>
  <div class="eye-container" style="top: 15%; right: 20%; transform: scale(0.8);"><div class="eye"><div class="pupil"></div></div></div>
  <div class="eye-container" style="top: 60%; left: 80%; transform: scale(1.5);"><div class="eye"><div class="pupil"></div></div></div>
  <div class="eye-container" style="bottom: 25%; left: 25%; transform: scale(1.2);"><div class="eye"><div class="pupil"></div></div></div>

  <div class="flash-bang" id="flash">WAKE UP!</div>

  <a href="../aero/index.html" class="escape-btn real-btn" id="escape-btn">I want to wake up.</a>

  <script>
    // 1. 目玉の追従
    document.addEventListener('mousemove', (e) => {
      const eyes = document.querySelectorAll('.eye');
      eyes.forEach(eye => {
        const rect = eye.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;
        const rad = Math.atan2(e.clientX - x, e.clientY - y);
        const rot = (rad * (180 / Math.PI) * -1) + 180;
        eye.style.transform = `rotate(${rot}deg)`;
      });
    });

    // 2. 狂った時計の逆回転アニメーション
    let crazyAngle = 0;
    setInterval(() => {
      crazyAngle -= 15; // 超高速で逆回転
      document.getElementById('crazy-second').style.transform = `translateX(-50%) rotate(${crazyAngle}deg)`;
      document.getElementById('crazy-minute').style.transform = `translateX(-50%) rotate(${crazyAngle / 12}deg)`;
      document.getElementById('crazy-hour').style.transform = `translateX(-50%) rotate(${crazyAngle / 60}deg)`;
    }, 50);

    // 3. 画面クリック時の狂気ギミック
    const textContainer = document.getElementById('text-container');
    const flash = document.getElementById('flash');
    const mainText = document.getElementById('main-text');
    const messages = ["Wake up.", "You are dreaming.", "No escape.", "IT HURTS", "Is this real?", "Look behind you."];
    const colors = ['#ff0000', '#ffff00', '#00ff00', '#ff00ff', '#00ffff'];

    document.addEventListener('click', (e) => {
      if(e.target.id === 'escape-btn') return;

      flash.style.opacity = 1;
      setTimeout(() => { flash.style.opacity = 0; }, 50);

      const span = document.createElement('div');
      span.className = 'floating-text';
      span.innerText = messages[Math.floor(Math.random() * messages.length)];
      span.style.left = e.clientX + 'px';
      span.style.top = e.clientY + 'px';
      span.style.color = colors[Math.floor(Math.random() * colors.length)];
      span.style.transform = `translate(-50%, -50%) rotate(${Math.random() * 40 - 20}deg) scale(${Math.random() * 2 + 0.5})`;
      textContainer.appendChild(span);

      mainText.style.letterSpacing = (Math.random() * 40) + 'px';
      mainText.style.transform = `translate(-50%, -50%) rotate(${Math.random() * 20 - 10}deg) scale(${Math.random() * 0.8 + 1})`;
    });

    // 4. ★ 理論値レベルの鬼畜ボタンギミック ★
    const escapeBtn = document.getElementById('escape-btn');
    const dummyContainer = document.getElementById('dummy-btn-container');
    
    // マウスが乗った瞬間にテレポートする
    escapeBtn.addEventListener('mouseenter', function() {
      // 98%の確率で容赦なく逃げる（残り2%は一瞬だけ留まる隙ができる）
      if (Math.random() < 0.98) {
        teleportButton(this);
      } else {
        // 運良く逃げなかった場合も、0.3秒後には逃げる
        setTimeout(() => { teleportButton(this); }, 300);
      }
    });

    // クリックしようとしてマウスを動かしただけでも逃げる（極悪）
    escapeBtn.addEventListener('mousemove', function() {
      if (Math.random() < 0.3) teleportButton(this);
    });

    function teleportButton(btn) {
      // 現在の位置を記憶して、そこにダミーを残す
      const currentRect = btn.getBoundingClientRect();
      createDummy(currentRect.left, currentRect.top);

      // 新しい座標を計算（画面外に出ないように）
      const maxX = window.innerWidth - btn.offsetWidth - 20;
      const maxY = window.innerHeight - btn.offsetHeight - 20;
      const newX = Math.max(20, Math.random() * maxX);
      const newY = Math.max(20, Math.random() * maxY);
      
      btn.style.position = 'absolute';
      btn.style.left = newX + 'px';
      btn.style.top = newY + 'px';
      // 中央揃えの transform を解除して、不規則な回転を加える
      btn.style.transform = `rotate(${Math.random() * 30 - 15}deg) scale(${Math.random() * 0.4 + 0.6})`;
    }

    // 偽物の出口（ダミーボタン）を生成する関数
    function createDummy(x, y) {
      const dummy = document.createElement('div');
      dummy.className = 'escape-btn dummy-btn';
      dummy.innerText = "I want to wake up.";
      dummy.style.position = 'absolute';
      dummy.style.left = x + 'px';
      dummy.style.top = y + 'px';
      // ダミーは押せない。押すと文字が変わる
      dummy.onclick = function() {
        this.innerText = "Fake.";
        this.style.background = "#000";
        this.style.color = "red";
        this.style.textDecoration = "line-through";
        this.style.pointerEvents = "none";
      };
      dummyContainer.appendChild(dummy);
    }
  </script>
</body>
</html>
