@import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap');

html, body {
  margin: 0; padding: 0; width: 100vw; height: 100vh;
  overflow: hidden; background: #000;
  font-family: 'Comic Sans MS', 'Comic Neue', cursive, sans-serif;
  cursor: crosshair; 
  user-select: none;
}

/* フィルム粒子 */
.grain {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: url('https://www.transparenttextures.com/patterns/stardust.png');
  opacity: 0.3; z-index: 100; pointer-events: none;
  animation: grain-jump 0.1s steps(1) infinite;
}
@keyframes grain-jump { 0% { background-position: 0 0; } 50% { background-position: 10% 5%; } 100% { background-position: -5% 10%; } }

/* 周辺減光（JSで色が変わる） */
.vignette {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.8) 100%);
  z-index: 101; pointer-events: none; transition: background 0.1s;
}

/* 歪んだ景色 */
.world-container { width: 100%; height: 100%; filter: url(#horror-warp) contrast(1.2) saturate(1.5); transition: filter 0.1s; }
.sky { height: 60%; background: linear-gradient(to bottom, #0047ff, #00e0ff); }
.ground { height: 40%; background: #008100; background-image: repeating-linear-gradient(45deg, rgba(0,0,0,0.1) 0px, transparent 2px); border-top: 5px solid #fff; }

.dream-obj { position: absolute; filter: drop-shadow(0 0 20px rgba(255,255,255,0.5)); pointer-events: none; }
.cloud-1 { top: 10%; left: 5%; width: 300px; opacity: 0.8; animation: drift 60s linear infinite;}
.cloud-2 { top: 20%; right: -50px; width: 400px; opacity: 0.6; animation: drift 40s linear infinite reverse;}
.rainbow-mirror { top: 0; left: 10%; width: 80%; transform: rotate(180deg); opacity: 0.4; mix-blend-mode: color-dodge; }

@keyframes drift { from { transform: translateX(-200px); } to { transform: translateX(120vw); } }

/* CRT走査線 */
.vhs-lines { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%); background-size: 100% 4px; z-index: 99; pointer-events: none; }

/* 時計 */
.nightmare-clock { position: absolute; top: 5%; left: 50%; transform: translateX(-50%); width: 150px; height: 150px; border-radius: 50%; background: rgba(255,255,255,0.2); border: 5px solid #fff; box-shadow: 0 0 30px red, inset 0 0 20px blue; z-index: 8; opacity: 0.7; }
.clock-inner { position: relative; width: 100%; height: 100%; }
.hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom center; transform: translateX(-50%); border-radius: 10px; }
.hour { width: 8px; height: 30%; background: #000; } .min { width: 4px; height: 45%; background: #555; } .sec { width: 2px; height: 50%; background: red; }

/* タイトル */
.main-title { position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%); font-size: 10vw; color: #fff; text-transform: uppercase; -webkit-text-stroke: 2px #000; text-shadow: 10px 10px 0px #ff0000, 20px 20px 0px #0000ff; z-index: 50; animation: title-shake 0.5s infinite; transition: letter-spacing 0.1s, transform 0.1s; pointer-events: none; white-space: nowrap;}
@keyframes title-shake { 0% { margin-left: -5px; } 50% { margin-left: 5px; } }

/* 脱出ボタン */
.the-exit { position: absolute; bottom: 10%; left: 50%; transform: translateX(-50%); padding: 20px 40px; background: #fff; border: 5px solid #000; font-size: 2rem; color: #000; text-decoration: none; box-shadow: 10px 10px 0 #ff0000; z-index: 200; cursor: pointer; transition: all 0.05s linear; }
.the-exit:hover { background: #ff0000; color: #fff; transform: scale(1.1) !important; }
.dummy { opacity: 0.5; pointer-events: none; filter: grayscale(1); z-index: 199; transform: none !important;}

/* =========================================
   ★ 追跡してくる怪物 (Glitch Entity) ★
   ========================================= */
.glitch-entity {
  position: absolute;
  width: 100px; height: 100px;
  transform: translate(-50%, -50%); /* 中心を座標の基準にする */
  z-index: 150;
  pointer-events: none; /* マウスイベントを貫通させる */
}

/* 怪物の本体（黒いノイズの塊） */
.entity-core {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
  width: 60px; height: 60px;
  background: #000;
  border-radius: 50%;
  filter: blur(5px);
  animation: pulse-core 0.5s infinite alternate;
}
@keyframes pulse-core {
  0% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 20px red; }
  100% { transform: translate(-50%, -50%) scale(1.2); box-shadow: 0 0 40px darkred; }
}

/* 怪物のオーラ（グリッチエフェクト） */
.entity-aura {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,0,0,0.5) 10px, rgba(255,0,0,0.5) 20px);
  border-radius: 50%;
  animation: spin-aura 2s linear infinite;
  mix-blend-mode: difference;
}
@keyframes spin-aura { 100% { transform: rotate(360deg); } }

/* 怪物の目玉 */
.eye { position: absolute; top: 20px; left: 20px; width: 60px; height: 60px; background: #fff; border-radius: 50%; border: 3px solid #000; display: flex; justify-content: center; align-items: center; overflow: hidden;}
.pupil { width: 25px; height: 25px; background: #000; border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
.pupil::after { content: ''; position: absolute; top: 20%; left: 20%; width: 5px; height: 5px; background: white; border-radius: 50%; }

/* =========================================
   ゲームオーバー画面
   ========================================= */
.game-over-screen {
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background: #000; color: red;
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  z-index: 9999; opacity: 0; pointer-events: none;
  transition: opacity 0.5s;
  font-family: "Courier New", Courier, monospace;
}
.game-over-screen h1 { font-size: 5rem; text-shadow: 0 0 20px red; margin: 0; animation: glitch-anim 0.2s infinite;}
.game-over-screen p { font-size: 1.5rem; color: #fff; margin-top: 20px; }

/* 画面揺れ */
@keyframes shake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -2px); } 100% { transform: translate(2px, 2px); } }

.pop-text { position: fixed; font-size: 4rem; color: red; font-weight: bold; text-shadow: 2px 2px 0 yellow; pointer-events: none; z-index: 300; animation: fade-out 0.5s forwards; }
@keyframes fade-out { to { opacity: 0; transform: translateY(-50px) scale(2); } }
